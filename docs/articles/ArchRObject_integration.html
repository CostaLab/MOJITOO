<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MOJITOO">
<title>Using MOJITOO in R for ArchR â€¢ MOJITOO</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Using MOJITOO in R for ArchR">
<meta property="og:description" content="MOJITOO">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MOJITOO</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/ArchRObject_integration.html">Using MOJITOO in R for ArchR</a>
    <a class="dropdown-item" href="../articles/SeuratObject_integration.html">Using MOJITOO in R for Seurat</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Using MOJITOO in R for ArchR</h1>
                        <h4 data-toc-skip class="author">Mingbo
Cheng</h4>
            
            <h4 data-toc-skip class="date">May 02, 2022</h4>
      
      
      <div class="d-none name"><code>ArchRObject_integration.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="download-data">1. download data<a class="anchor" aria-label="anchor" href="#download-data"></a>
</h3>
<pre><code><span class="co">## 2022-05-02 17:07:31 URL:https://cf.10xgenomics.com/samples/cell-arc/1.0.0/pbmc_granulocyte_sorted_10k/pbmc_granulocyte_sorted_10k_atac_fragments.tsv.gz [2051027831/2051027831] -&gt; "pbmc_granulocyte_sorted_10k_atac_fragments.tsv.gz" [1]</span>
<span class="co">## 2022-05-02 17:07:32 URL:https://cf.10xgenomics.com/samples/cell-arc/1.0.0/pbmc_granulocyte_sorted_10k/pbmc_granulocyte_sorted_10k_atac_fragments.tsv.gz.tbi [1027204/1027204] -&gt; "pbmc_granulocyte_sorted_10k_atac_fragments.tsv.gz.tbi" [1]</span>
<span class="co">## 2022-05-02 17:07:33 URL:https://uc2e99488f9d608bc8cd77316676.dl.dropboxusercontent.com/cd/0/inline/BkiCO7CY1DavkuGDqXpdRi5IDk_bfz4QbyIorFGDgpRVz_sFTbOQqDqBAL75Ai4wLIYdz8IXIhsQ-wKGhSR7tkxmulUrXpTX2_n9exX93GHIZ8Ewd0ez3IV63O9-llNlVSAojpBLkkg08mBc0j76BZQEvY0BeCKuQ3CRbTvd4xogGA/file [400178/400178] -&gt; "PBMC-Multiom_annotation.tsv" [1]</span>
<span class="co">## 2022-05-02 17:08:08 URL:https://cf.10xgenomics.com/samples/cell-arc/1.0.0/pbmc_granulocyte_sorted_10k/pbmc_granulocyte_sorted_10k_filtered_feature_bc_matrix.h5 [162282142/162282142] -&gt; "pbmc_granulocyte_sorted_10k_filtered_feature_bc_matrix.h5" [1]</span></code></pre>
</div>
<div class="section level3">
<h3 id="library">2. library<a class="anchor" aria-label="anchor" href="#library"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">MOJITOO</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">ArchR</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">parallel</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://satijalab.org/seurat" class="external-link">Seurat</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://nanx.me/ggsci/" class="external-link">ggsci</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://stringr.tidyverse.org" class="external-link">stringr</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">EnsDb.Hsapiens.v86</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/addArchRGenome.html" class="external-link">addArchRGenome</a></span><span class="op">(</span><span class="st">"hg38"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Setting default genome to Hg38.</span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/addArchRThreads.html" class="external-link">addArchRThreads</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Input threads is equal to or greater than ncores minus 1 (7)</span>
<span class="co">## Setting cores to ncores minus 2. Set force = TRUE to set above this number!</span></code></pre>
<pre><code><span class="co">## Setting default number of Parallel threads to 6.</span></code></pre>
</div>
<div class="section level3">
<h3 id="create-archr-proj">3. Create ArchR proj<a class="anchor" aria-label="anchor" href="#create-archr-proj"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">inputFiles</span> <span class="op">&lt;-</span> <span class="st">"./pbmc_granulocyte_sorted_10k_atac_fragments.tsv.gz"</span>
<span class="va">ArrowFiles</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/createArrowFiles.html" class="external-link">createArrowFiles</a></span><span class="op">(</span>inputFiles <span class="op">=</span> <span class="va">inputFiles</span>,
                               sampleNames <span class="op">=</span> <span class="st">"pbmc"</span>,
                               minTSS <span class="op">=</span> <span class="fl">0</span>, <span class="co">##4</span>
                               minFrags <span class="op">=</span> <span class="fl">0</span>, <span class="co">## 1000</span>
                               addTileMat <span class="op">=</span> <span class="cn">T</span>,
                               addGeneScoreMat <span class="op">=</span> <span class="cn">F</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using GeneAnnotation set by addArchRGenome(Hg38)!</span>
<span class="co">## Using GeneAnnotation set by addArchRGenome(Hg38)!</span></code></pre>
<pre><code><span class="co">## ArchR logging to : ArchRLogs/ArchR-createArrows-71002bd84768-Date-2022-05-02_Time-17-08-19.log</span>
<span class="co">## If there is an issue, please report to github with logFile!</span></code></pre>
<pre><code><span class="co">## Cleaning Temporary Files</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:08:19 : Batch Execution w/ safelapply!, 0 mins elapsed.</span></code></pre>
<pre><code><span class="co">## (pbmc : 1 of 1) Determining Arrow Method to use!</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:08:19 : (pbmc : 1 of 1) Reading In Fragments from inputFiles (readMethod = tabix), 0 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:08:19 : (pbmc : 1 of 1) Tabix Bed To Temporary File, 0 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:18:21 : (pbmc : 1 of 1) Successful creation of Temporary File, 10.047 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:18:21 : (pbmc : 1 of 1) Creating ArrowFile From Temporary File, 10.047 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:20:16 : (pbmc : 1 of 1) Successful creation of Arrow File, 11.956 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:21:47 : (pbmc : 1 of 1) CellStats : Number of Cells Pass Filter = 639351 , 13.473 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:21:47 : (pbmc : 1 of 1) CellStats : Median Frags = 5 , 13.473 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:21:47 : (pbmc : 1 of 1) CellStats : Median TSS Enrichment = 0.099 , 13.473 mins elapsed.</span></code></pre>
<pre><code><span class="co">## WARNING: Error found with Cairo installation. Continuing without rasterization.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:22:01 : (pbmc : 1 of 1) Adding Additional Feature Counts!, 13.705 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:23:21 : (pbmc : 1 of 1) Removing Fragments from Filtered Cells, 15.042 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:23:21 : (pbmc : 1 of 1) Creating Filtered Arrow File, 15.042 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:24:10 : (pbmc : 1 of 1) Finished Constructing Filtered Arrow File!, 15.86 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:24:12 : (pbmc : 1 of 1) Adding TileMatrix!, 15.898 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:26:12 : (pbmc : 1 of 1) Finished Creating Arrow File, 17.899 mins elapsed.</span></code></pre>
<pre><code><span class="co">## ArchR logging successful to : ArchRLogs/ArchR-createArrows-71002bd84768-Date-2022-05-02_Time-17-08-19.log</span></code></pre>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ArrowFiles</span> <span class="op">&lt;-</span> <span class="st">"pbmc.arrow"</span>
<span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/ArchRProject.html" class="external-link">ArchRProject</a></span><span class="op">(</span>ArrowFiles <span class="op">=</span> <span class="va">ArrowFiles</span>, outputDirectory <span class="op">=</span> <span class="st">"PBMC"</span>, 
                     copyArrows <span class="op">=</span> <span class="cn">T</span>, showLogo<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Using GeneAnnotation set by addArchRGenome(Hg38)!</span></code></pre>
<pre><code><span class="co">## Using GeneAnnotation set by addArchRGenome(Hg38)!</span></code></pre>
<pre><code><span class="co">## Validating Arrows...</span></code></pre>
<pre><code><span class="co">## Getting SampleNames...</span></code></pre>
<pre><code><span class="co">## 1 </span>
<span class="co">## Copying ArrowFiles to Ouptut Directory! If you want to save disk space set copyArrows = FALSE</span>
<span class="co">## 1 </span>
<span class="co">## Getting Cell Metadata...</span>
<span class="co">## 1 </span>
<span class="co">## Merging Cell Metadata...</span>
<span class="co">## Initializing ArchRProject...</span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"PBMC-Multiom_annotation.tsv"</span>, sep<span class="op">=</span><span class="st">"\t"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pbmc#"</span>, <span class="op">(</span><span class="va">meta</span><span class="op">$</span><span class="va">barcode</span><span class="op">)</span><span class="op">)</span>

<span class="va">bc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">proj</span><span class="op">@</span><span class="va">cellColData</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span><span class="op">)</span>
<span class="va">meta</span> <span class="op">&lt;-</span> <span class="va">meta</span><span class="op">[</span><span class="va">bc</span>, <span class="op">]</span>
<span class="va">proj</span> <span class="op">&lt;-</span> <span class="va">proj</span><span class="op">[</span><span class="va">bc</span>, <span class="op">]</span>
<span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setCellCol.html">setCellCol</a></span><span class="op">(</span><span class="va">proj</span>, meta<span class="op">=</span><span class="va">meta</span><span class="op">)</span>


<span class="va">gene.coords</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-exonsBy.html" class="external-link">genes</a></span><span class="op">(</span><span class="va">EnsDb.Hsapiens.v86</span>, filter <span class="op">=</span> <span class="op">~</span> <span class="va">gene_biotype</span> <span class="op">==</span> <span class="st">"protein_coding"</span><span class="op">)</span>
<span class="va">ucsc.levels</span> <span class="op">&lt;-</span> <span class="fu">stringr</span><span class="fu">::</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html" class="external-link">str_replace</a></span><span class="op">(</span>string<span class="op">=</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"chr"</span>,<span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">seqlevels</a></span><span class="op">(</span><span class="va">gene.coords</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">""</span><span class="op">)</span>, pattern<span class="op">=</span><span class="st">"chrMT"</span>, replacement<span class="op">=</span><span class="st">"chrM"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ensembldb/man/EnsDb-class.html" class="external-link">seqlevels</a></span><span class="op">(</span><span class="va">gene.coords</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">ucsc.levels</span>
<span class="va">genebody.coords</span> <span class="op">&lt;-</span> <span class="fu">keepStandardChromosomes</span><span class="op">(</span><span class="va">gene.coords</span>, pruning.mode <span class="op">=</span> <span class="st">'coarse'</span><span class="op">)</span>

<span class="va">mtxs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/Read10X_h5.html" class="external-link">Read10X_h5</a></span><span class="op">(</span><span class="st">"pbmc_granulocyte_sorted_10k_filtered_feature_bc_matrix.h5"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Genome matrix has multiple modalities, returning a list of matrices for this genome</span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">RNA</span> <span class="op">&lt;-</span> <span class="va">mtxs</span><span class="op">[[</span><span class="st">"Gene Expression"</span><span class="op">]</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">RNA</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"pbmc#"</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">RNA</span><span class="op">)</span><span class="op">)</span>
<span class="va">RNA</span> <span class="op">&lt;-</span> <span class="va">RNA</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">proj</span><span class="op">@</span><span class="va">cellColData</span><span class="op">)</span><span class="op">]</span>

<span class="va">inter_gene_name</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setops.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">RNA</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-class.html" class="external-link">elementMetadata</a></span><span class="op">(</span><span class="va">genebody.coords</span><span class="op">)</span><span class="op">$</span><span class="va">gene_name</span><span class="op">)</span>

<span class="va">gtfMatch</span> <span class="op">&lt;-</span> <span class="va">genebody.coords</span><span class="op">[</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/na.omit.data.table.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/Vector-comparison.html" class="external-link">match</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">RNA</span><span class="op">)</span>, <span class="va">genebody.coords</span><span class="op">$</span><span class="va">gene_name</span><span class="op">)</span><span class="op">)</span><span class="op">]</span>
<span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">gtfMatch</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">gtfMatch</span><span class="op">$</span><span class="va">gene_name</span>


<span class="va">seRNA</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/RangedSummarizedExperiment-class.html" class="external-link">SummarizedExperiment</a></span><span class="op">(</span>
  assays <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/S4Vectors/man/SimpleList-class.html" class="external-link">SimpleList</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">RNA</span><span class="op">[</span><span class="va">inter_gene_name</span>, <span class="op">]</span><span class="op">)</span>,
  rowData <span class="op">=</span> <span class="va">gtfMatch</span>
<span class="op">)</span>
<span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/addGeneExpressionMatrix.html" class="external-link">addGeneExpressionMatrix</a></span><span class="op">(</span><span class="va">proj</span>, <span class="va">seRNA</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## ArchR logging to : ArchRLogs/ArchR-addGeneExpressionMatrix-710041238866-Date-2022-05-02_Time-17-26-31.log</span>
<span class="co">## If there is an issue, please report to github with logFile!</span>
<span class="co">## Overlap w/ scATAC = 1</span>
<span class="co">## 2022-05-02 17:26:32 : </span>
<span class="co">## Overlap Per Sample w/ scATAC : pbmc=11763</span>
<span class="co">## 2022-05-02 17:26:32 : </span>
<span class="co">## 2022-05-02 17:26:33 : Batch Execution w/ safelapply!, 0 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:34 : Adding pbmc to GeneExpressionMatrix for Chr (1 of 23)!, 0.016 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:35 : Adding pbmc to GeneExpressionMatrix for Chr (2 of 23)!, 0.039 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:37 : Adding pbmc to GeneExpressionMatrix for Chr (3 of 23)!, 0.058 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:38 : Adding pbmc to GeneExpressionMatrix for Chr (4 of 23)!, 0.086 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:39 : Adding pbmc to GeneExpressionMatrix for Chr (5 of 23)!, 0.106 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:41 : Adding pbmc to GeneExpressionMatrix for Chr (6 of 23)!, 0.126 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:42 : Adding pbmc to GeneExpressionMatrix for Chr (7 of 23)!, 0.152 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:43 : Adding pbmc to GeneExpressionMatrix for Chr (8 of 23)!, 0.171 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:44 : Adding pbmc to GeneExpressionMatrix for Chr (9 of 23)!, 0.19 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:46 : Adding pbmc to GeneExpressionMatrix for Chr (10 of 23)!, 0.217 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:47 : Adding pbmc to GeneExpressionMatrix for Chr (11 of 23)!, 0.237 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:48 : Adding pbmc to GeneExpressionMatrix for Chr (12 of 23)!, 0.256 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:50 : Adding pbmc to GeneExpressionMatrix for Chr (13 of 23)!, 0.284 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:51 : Adding pbmc to GeneExpressionMatrix for Chr (14 of 23)!, 0.303 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:52 : Adding pbmc to GeneExpressionMatrix for Chr (15 of 23)!, 0.321 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:54 : Adding pbmc to GeneExpressionMatrix for Chr (16 of 23)!, 0.348 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:55 : Adding pbmc to GeneExpressionMatrix for Chr (17 of 23)!, 0.367 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:56 : Adding pbmc to GeneExpressionMatrix for Chr (18 of 23)!, 0.388 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:58 : Adding pbmc to GeneExpressionMatrix for Chr (19 of 23)!, 0.414 mins elapsed.</span>
<span class="co">## 2022-05-02 17:26:59 : Adding pbmc to GeneExpressionMatrix for Chr (20 of 23)!, 0.434 mins elapsed.</span>
<span class="co">## 2022-05-02 17:27:00 : Adding pbmc to GeneExpressionMatrix for Chr (21 of 23)!, 0.453 mins elapsed.</span>
<span class="co">## 2022-05-02 17:27:02 : Adding pbmc to GeneExpressionMatrix for Chr (22 of 23)!, 0.479 mins elapsed.</span>
<span class="co">## 2022-05-02 17:27:03 : Adding pbmc to GeneExpressionMatrix for Chr (23 of 23)!, 0.498 mins elapsed.</span>
<span class="co">## ArchR logging successful to : ArchRLogs/ArchR-addGeneExpressionMatrix-710041238866-Date-2022-05-02_Time-17-26-31.log</span></code></pre>
</div>
<div class="section level3">
<h3 id="rna-atac-dimension-reductions">4. RNA &amp; ATAC dimension reductions<a class="anchor" aria-label="anchor" href="#rna-atac-dimension-reductions"></a>
</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/addIterativeLSI.html" class="external-link">addIterativeLSI</a></span><span class="op">(</span>ArchRProj <span class="op">=</span> <span class="va">proj</span>,
                        useMatrix <span class="op">=</span> <span class="st">"TileMatrix"</span>,
                        name <span class="op">=</span> <span class="st">"IterativeLSI"</span>,
                        iterations <span class="op">=</span> <span class="fl">2</span>,
                        varFeatures <span class="op">=</span> <span class="fl">25000</span>,
                        dimsToUse <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Checking Inputs...</span></code></pre>
<pre><code><span class="co">## ArchR logging to : ArchRLogs/ArchR-addIterativeLSI-71004d2ffa79-Date-2022-05-02_Time-17-27-05.log</span>
<span class="co">## If there is an issue, please report to github with logFile!</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:27:06 : Computing Total Across All Features, 0 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:27:06 : Computing Top Features, 0.008 mins elapsed.</span></code></pre>
<pre><code><span class="co">## ###########</span>
<span class="co">## 2022-05-02 17:27:07 : Running LSI (1 of 2) on Top Features, 0.025 mins elapsed.</span>
<span class="co">## ###########</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:27:07 : Sampling Cells (N = 10000) for Estimated LSI, 0.026 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:27:07 : Creating Sampled Partial Matrix, 0.026 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:27:32 : Computing Estimated LSI (projectAll = FALSE), 0.433 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:28:22 : Identifying Clusters, 1.269 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:28:32 : Identified 6 Clusters, 1.433 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:28:32 : Saving LSI Iteration, 1.433 mins elapsed.</span></code></pre>
<pre><code><span class="co">## WARNING: Error found with Cairo installation. Continuing without rasterization.</span>
<span class="co">## WARNING: Error found with Cairo installation. Continuing without rasterization.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:28:43 : Creating Cluster Matrix on the total Group Features, 1.618 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:29:27 : Computing Variable Features, 2.355 mins elapsed.</span></code></pre>
<pre><code><span class="co">## ###########</span>
<span class="co">## 2022-05-02 17:29:27 : Running LSI (2 of 2) on Variable Features, 2.356 mins elapsed.</span>
<span class="co">## ###########</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:29:27 : Creating Partial Matrix, 2.356 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:29:49 : Computing LSI, 2.725 mins elapsed.</span></code></pre>
<pre><code><span class="co">## 2022-05-02 17:30:04 : Finished Running IterativeLSI, 2.982 mins elapsed.</span></code></pre>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/CreateSeuratObject.html" class="external-link">CreateSeuratObject</a></span><span class="op">(</span>counts<span class="op">=</span><span class="va">RNA</span>, assay<span class="op">=</span><span class="st">"RNA"</span><span class="op">)</span>
<span class="va">object</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/NormalizeData.html" class="external-link">NormalizeData</a></span><span class="op">(</span><span class="va">object</span>, normalization.method <span class="op">=</span> <span class="st">"LogNormalize"</span>, scale.factor <span class="op">=</span> <span class="fl">10000</span>, verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/FindVariableFeatures.html" class="external-link">FindVariableFeatures</a></span><span class="op">(</span><span class="va">object</span>, nfeatures<span class="op">=</span><span class="fl">3000</span>, verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://satijalab.org/seurat/reference/ScaleData.html" class="external-link">ScaleData</a></span><span class="op">(</span><span class="va">object</span>, verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span>
<span class="va">object</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://satijalab.org/seurat/reference/RunPCA.html" class="external-link">RunPCA</a></span><span class="op">(</span><span class="va">object</span>, npcs<span class="op">=</span><span class="fl">50</span>, reduction.name<span class="op">=</span><span class="st">"RNA_PCA"</span>, verbose<span class="op">=</span><span class="cn">F</span><span class="op">)</span>

<span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/setDimRed.html">setDimRed</a></span><span class="op">(</span><span class="va">proj</span>, mtx<span class="op">=</span><span class="fu"><a href="https://mojaveazure.github.io/seurat-object/reference/Embeddings.html" class="external-link">Embeddings</a></span><span class="op">(</span><span class="va">object</span><span class="op">[[</span><span class="st">"RNA_PCA"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, type<span class="op">=</span><span class="st">"reducedDims"</span>, reduction.name<span class="op">=</span><span class="st">"RNA_PCA"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/saveArchRProject.html" class="external-link">saveArchRProject</a></span><span class="op">(</span><span class="va">proj</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Saving ArchRProject...</span></code></pre>
<pre><code><span class="co">## Loading ArchRProject...</span></code></pre>
<pre><code><span class="co">## Successfully loaded ArchRProject!</span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">##                                                    / |</span>
<span class="co">##                                                  /    \</span>
<span class="co">##             .                                  /      |.</span>
<span class="co">##             \\\                              /        |.</span>
<span class="co">##               \\\                          /           `|.</span>
<span class="co">##                 \\\                      /              |.</span>
<span class="co">##                   \                    /                |\</span>
<span class="co">##                   \\#####\           /                  ||</span>
<span class="co">##                 ==###########&gt;      /                   ||</span>
<span class="co">##                  \\##==......\    /                     ||</span>
<span class="co">##             ______ =       =|__ /__                     ||      \\\</span>
<span class="co">##         ,--' ,----`-,__ ___/'  --,-`-===================##========&gt;</span>
<span class="co">##        \               '        ##_______ _____ ,--,__,=##,__   ///</span>
<span class="co">##         ,    __==    ___,-,__,--'#'  ==='      `-'    | ##,-/</span>
<span class="co">##         -,____,---'       \\####\\________________,--\\_##,/</span>
<span class="co">##            ___      .______        ______  __    __  .______      </span>
<span class="co">##           /   \     |   _  \      /      ||  |  |  | |   _  \     </span>
<span class="co">##          /  ^  \    |  |_)  |    |  ,----'|  |__|  | |  |_)  |    </span>
<span class="co">##         /  /_\  \   |      /     |  |     |   __   | |      /     </span>
<span class="co">##        /  _____  \  |  |\  \\___ |  `----.|  |  |  | |  |\  \\___.</span>
<span class="co">##       /__/     \__\ | _| `._____| \______||__|  |__| | _| `._____|</span>
<span class="co">## </span></code></pre>
<pre><code><span class="co">## </span>
<span class="co">##            ___      .______        ______  __    __  .______      </span>
<span class="co">##           /   \     |   _  \      /      ||  |  |  | |   _  \     </span>
<span class="co">##          /  ^  \    |  |_)  |    |  ,----'|  |__|  | |  |_)  |    </span>
<span class="co">##         /  /_\  \   |      /     |  |     |   __   | |      /     </span>
<span class="co">##        /  _____  \  |  |\  \\___ |  `----.|  |  |  | |  |\  \\___.</span>
<span class="co">##       /__/     \__\ | _| `._____| \______||__|  |__| | _| `._____|</span>
<span class="co">## </span></code></pre>
<pre><code><span class="co">## class: ArchRProject </span>
<span class="co">## outputDirectory: /Users/zhijianli/Github/MOJITOO/vignettes/PBMC </span>
<span class="co">## samples(1): pbmc</span>
<span class="co">## sampleColData names(1): ArrowFiles</span>
<span class="co">## cellColData names(20): Sample nMultiFrags ... Gex_MitoRatio</span>
<span class="co">##   Gex_RiboRatio</span>
<span class="co">## numberOfCells(1): 11763</span>
<span class="co">## medianTSS(1): 13.659</span>
<span class="co">## medianFrags(1): 13486</span></code></pre>
</div>
<div class="section level3">
<h3 id="run-mojitoo">5. RUN MOJITOO<a class="anchor" aria-label="anchor" href="#run-mojitoo"></a>
</h3>
<div class="sourceCode" id="cb65"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/loadArchRProject.html" class="external-link">loadArchRProject</a></span><span class="op">(</span><span class="st">"PBMC"</span>, showLogo<span class="op">=</span><span class="cn">F</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## Successfully loaded ArchRProject!</span></code></pre>
<div class="sourceCode" id="cb67"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mojitoo.html">mojitoo</a></span><span class="op">(</span>
     object<span class="op">=</span><span class="va">proj</span>,
     reduction.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"RNA_PCA"</span>, <span class="st">"IterativeLSI"</span><span class="op">)</span>,
     dims.list <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">50</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">30</span><span class="op">)</span>,
     is.reduction.center<span class="op">=</span><span class="cn">T</span>,
     is.reduction.scale<span class="op">=</span><span class="cn">T</span>,
     reduction.name<span class="op">=</span><span class="st">'MOJITOO'</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">## processing RNA_PCA</span></code></pre>
<pre><code><span class="co">## adding IterativeLSI</span></code></pre>
<pre><code><span class="co">## 1 round cc 29</span></code></pre>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">proj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/addUMAP.html" class="external-link">addUMAP</a></span><span class="op">(</span>
    ArchRProj <span class="op">=</span> <span class="va">proj</span>,
    reducedDims <span class="op">=</span> <span class="st">"MOJITOO"</span>,
    name <span class="op">=</span> <span class="st">"MOJITOO_UMAP"</span>,
    nNeighbors <span class="op">=</span> <span class="fl">30</span>,
    minDist <span class="op">=</span> <span class="fl">0.5</span>,
    metric <span class="op">=</span> <span class="st">"cosine"</span>
<span class="op">)</span></code></pre></div>
<pre><code><span class="co">## 17:30:17 UMAP embedding parameters a = 0.583 b = 1.334</span></code></pre>
<pre><code><span class="co">## 17:30:17 Read 11763 rows and found 29 numeric columns</span></code></pre>
<pre><code><span class="co">## 17:30:17 Using Annoy for neighbor search, n_neighbors = 30</span></code></pre>
<pre><code><span class="co">## 17:30:17 Building Annoy index with metric = cosine, n_trees = 50</span></code></pre>
<pre><code><span class="co">## 0%   10   20   30   40   50   60   70   80   90   100%</span></code></pre>
<pre><code><span class="co">## [----|----|----|----|----|----|----|----|----|----|</span></code></pre>
<pre><code><span class="co">## **************************************************|</span>
<span class="co">## 17:30:17 Writing NN index file to temp file /var/folders/75/g5lhn91d62bgnv_gd4x0fc240000gn/T//RtmpCOg6B1/file71003cb22889</span>
<span class="co">## 17:30:17 Searching Annoy index using 4 threads, search_k = 3000</span>
<span class="co">## 17:30:18 Annoy recall = 100%</span>
<span class="co">## 17:30:19 Commencing smooth kNN distance calibration using 4 threads</span>
<span class="co">## 17:30:20 Initializing from normalized Laplacian + noise</span>
<span class="co">## 17:30:20 Commencing optimization for 200 epochs, with 462816 positive edges</span>
<span class="co">## 17:30:24 Optimization finished</span>
<span class="co">## 17:30:24 Creating temp model dir /var/folders/75/g5lhn91d62bgnv_gd4x0fc240000gn/T//RtmpCOg6B1/dir71007b690dd8</span>
<span class="co">## 17:30:24 Creating dir /var/folders/75/g5lhn91d62bgnv_gd4x0fc240000gn/T//RtmpCOg6B1/dir71007b690dd8</span>
<span class="co">## 17:30:25 Changing to /var/folders/75/g5lhn91d62bgnv_gd4x0fc240000gn/T//RtmpCOg6B1/dir71007b690dd8</span>
<span class="co">## 17:30:25 Creating /Users/zhijianli/Github/MOJITOO/vignettes/PBMC/Embeddings/Save-Uwot-UMAP-Params-MOJITOO-710054835980-Date-2022-05-02_Time-17-30-24.tar</span></code></pre>
</div>
<div class="section level3">
<h3 id="umap-of-true-labels">6. UMAP of True labels<a class="anchor" aria-label="anchor" href="#umap-of-true-labels"></a>
</h3>
<div class="sourceCode" id="cb79"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/ArchR/man/plotEmbedding.html" class="external-link">plotEmbedding</a></span><span class="op">(</span>ArchRProj <span class="op">=</span> <span class="va">proj</span>, colorBy <span class="op">=</span> <span class="st">"cellColData"</span>, name <span class="op">=</span> <span class="st">"annotation"</span>, embedding <span class="op">=</span> <span class="st">"MOJITOO_UMAP"</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## ArchR logging to : ArchRLogs/ArchR-plotEmbedding-71001dd4a68a-Date-2022-05-02_Time-17-30-25.log</span>
<span class="co">## If there is an issue, please report to github with logFile!</span></code></pre>
<pre><code><span class="co">## Getting UMAP Embedding</span></code></pre>
<pre><code><span class="co">## ColorBy = cellColData</span></code></pre>
<pre><code><span class="co">## Plotting Embedding</span></code></pre>
<pre><code><span class="co">## 1 WARNING: Error found with Cairo installation. Continuing without rasterization.</span>
<span class="co">## </span>
<span class="co">## ArchR logging successful to : ArchRLogs/ArchR-plotEmbedding-71001dd4a68a-Date-2022-05-02_Time-17-30-25.log</span></code></pre>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p</span></code></pre></div>
<p><img src="ArchRObject_integration_files/figure-html/UMAP-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="sessioninfo">7. sessionInfo<a class="anchor" aria-label="anchor" href="#sessioninfo"></a>
</h3>
<div class="sourceCode" id="cb86"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<pre><code><span class="co">## R version 4.2.0 (2022-04-22)</span>
<span class="co">## Platform: aarch64-apple-darwin21.3.0 (64-bit)</span>
<span class="co">## Running under: macOS Monterey 12.3.1</span>
<span class="co">## </span>
<span class="co">## Matrix products: default</span>
<span class="co">## BLAS:   /opt/homebrew/Cellar/openblas/0.3.20/lib/libopenblasp-r0.3.20.dylib</span>
<span class="co">## LAPACK: /opt/homebrew/Cellar/r/4.2.0/lib/R/lib/libRlapack.dylib</span>
<span class="co">## </span>
<span class="co">## locale:</span>
<span class="co">## [1] C/UTF-8/C/C/C/C</span>
<span class="co">## </span>
<span class="co">## attached base packages:</span>
<span class="co">##  [1] grid      parallel  stats4    stats     graphics  grDevices utils    </span>
<span class="co">##  [8] datasets  methods   base     </span>
<span class="co">## </span>
<span class="co">## other attached packages:</span>
<span class="co">##  [1] uwot_0.1.11                       nabor_0.5.0                      </span>
<span class="co">##  [3] gridExtra_2.3                     Rsamtools_2.12.0                 </span>
<span class="co">##  [5] BSgenome.Hsapiens.UCSC.hg38_1.4.4 BSgenome_1.64.0                  </span>
<span class="co">##  [7] rtracklayer_1.56.0                Biostrings_2.64.0                </span>
<span class="co">##  [9] XVector_0.36.0                    EnsDb.Hsapiens.v86_2.99.0        </span>
<span class="co">## [11] ensembldb_2.20.0                  AnnotationFilter_1.20.0          </span>
<span class="co">## [13] GenomicFeatures_1.48.0            AnnotationDbi_1.58.0             </span>
<span class="co">## [15] stringr_1.4.0                     ggsci_2.9                        </span>
<span class="co">## [17] sp_1.4-7                          SeuratObject_4.1.0               </span>
<span class="co">## [19] Seurat_4.1.1                      ArchR_1.0.1                      </span>
<span class="co">## [21] magrittr_2.0.3                    rhdf5_2.40.0                     </span>
<span class="co">## [23] Matrix_1.4-1                      data.table_1.14.2                </span>
<span class="co">## [25] SummarizedExperiment_1.26.0       Biobase_2.56.0                   </span>
<span class="co">## [27] GenomicRanges_1.48.0              GenomeInfoDb_1.32.1              </span>
<span class="co">## [29] IRanges_2.30.0                    S4Vectors_0.34.0                 </span>
<span class="co">## [31] BiocGenerics_0.42.0               MatrixGenerics_1.8.0             </span>
<span class="co">## [33] matrixStats_0.62.0                ggplot2_3.3.5                    </span>
<span class="co">## [35] MOJITOO_1.0                      </span>
<span class="co">## </span>
<span class="co">## loaded via a namespace (and not attached):</span>
<span class="co">##   [1] rappdirs_0.3.3           scattermore_0.8          ragg_1.2.2              </span>
<span class="co">##   [4] tidyr_1.2.0              bit64_4.0.5              knitr_1.39              </span>
<span class="co">##   [7] irlba_2.3.5              DelayedArray_0.22.0      rpart_4.1.16            </span>
<span class="co">##  [10] KEGGREST_1.36.0          RCurl_1.98-1.6           doParallel_1.0.17       </span>
<span class="co">##  [13] generics_0.1.2           cowplot_1.1.1            RSQLite_2.2.13          </span>
<span class="co">##  [16] RANN_2.6.1               future_1.25.0            bit_4.0.4               </span>
<span class="co">##  [19] spatstat.data_2.2-0      xml2_1.3.3               httpuv_1.6.5            </span>
<span class="co">##  [22] assertthat_0.2.1         xfun_0.30                hms_1.1.1               </span>
<span class="co">##  [25] jquerylib_0.1.4          evaluate_0.15            promises_1.2.0.1        </span>
<span class="co">##  [28] fansi_1.0.3              restfulr_0.0.13          progress_1.2.2          </span>
<span class="co">##  [31] dbplyr_2.1.1             igraph_1.3.1             DBI_1.1.2               </span>
<span class="co">##  [34] htmlwidgets_1.5.4        spatstat.geom_2.4-0      purrr_0.3.4             </span>
<span class="co">##  [37] ellipsis_0.3.2           RSpectra_0.16-1          ks_1.13.5               </span>
<span class="co">##  [40] dplyr_1.0.9              backports_1.4.1          biomaRt_2.52.0          </span>
<span class="co">##  [43] deldir_1.0-6             vctrs_0.4.1              here_1.0.1              </span>
<span class="co">##  [46] ROCR_1.0-11              abind_1.4-5              withr_2.5.0             </span>
<span class="co">##  [49] cachem_1.0.6             Gviz_1.40.0              progressr_0.10.0        </span>
<span class="co">##  [52] checkmate_2.1.0          sctransform_0.3.3        GenomicAlignments_1.32.0</span>
<span class="co">##  [55] prettyunits_1.1.1        mclust_5.4.9             goftest_1.2-3           </span>
<span class="co">##  [58] cluster_2.1.3            lazyeval_0.2.2           crayon_1.5.1            </span>
<span class="co">##  [61] hdf5r_1.3.5              labeling_0.4.2           pkgconfig_2.0.3         </span>
<span class="co">##  [64] nlme_3.1-157             ProtGenerics_1.28.0      nnet_7.3-17             </span>
<span class="co">##  [67] rlang_1.0.2              globals_0.14.0           lifecycle_1.0.1         </span>
<span class="co">##  [70] miniUI_0.1.1.1           filelock_1.0.2           BiocFileCache_2.4.0     </span>
<span class="co">##  [73] dichromat_2.0-0.1        rprojroot_2.0.3          polyclip_1.10-0         </span>
<span class="co">##  [76] lmtest_0.9-40            Rhdf5lib_1.18.0          zoo_1.8-10              </span>
<span class="co">##  [79] base64enc_0.1-3          ggridges_0.5.3           GlobalOptions_0.1.2     </span>
<span class="co">##  [82] png_0.1-7                viridisLite_0.4.0        rjson_0.2.21            </span>
<span class="co">##  [85] bitops_1.0-7             KernSmooth_2.23-20       rhdf5filters_1.8.0      </span>
<span class="co">##  [88] blob_1.2.3               shape_1.4.6              parallelly_1.31.1       </span>
<span class="co">##  [91] spatstat.random_2.2-0    jpeg_0.1-9               scales_1.2.0            </span>
<span class="co">##  [94] memoise_2.0.1            plyr_1.8.7               ica_1.0-2               </span>
<span class="co">##  [97] zlibbioc_1.42.0          hdrcde_3.4               compiler_4.2.0          </span>
<span class="co">## [100] BiocIO_1.6.0             RColorBrewer_1.1-3       clue_0.3-60             </span>
<span class="co">## [103] fitdistrplus_1.1-8       cli_3.3.0                listenv_0.8.0           </span>
<span class="co">## [106] patchwork_1.1.1          pbapply_1.5-0            htmlTable_2.4.0         </span>
<span class="co">## [109] Formula_1.2-4            MASS_7.3-57              mgcv_1.8-40             </span>
<span class="co">## [112] tidyselect_1.1.2         stringi_1.7.6            textshaping_0.3.6       </span>
<span class="co">## [115] highr_0.9                yaml_2.3.5               latticeExtra_0.6-29     </span>
<span class="co">## [118] ggrepel_0.9.1            sass_0.4.1               VariantAnnotation_1.42.0</span>
<span class="co">## [121] tools_4.2.0              future.apply_1.9.0       circlize_0.4.14         </span>
<span class="co">## [124] rstudioapi_0.13          foreach_1.5.2            foreign_0.8-82          </span>
<span class="co">## [127] farver_2.1.0             Rtsne_0.16               digest_0.6.29           </span>
<span class="co">## [130] rgeos_0.5-9              pracma_2.3.8             shiny_1.7.1             </span>
<span class="co">## [133] Rcpp_1.0.8.3             later_1.3.0              RcppAnnoy_0.0.19        </span>
<span class="co">## [136] fda_6.0.3                httr_1.4.2               biovizBase_1.44.0       </span>
<span class="co">## [139] ComplexHeatmap_2.12.0    colorspace_2.0-3         rainbow_3.6             </span>
<span class="co">## [142] XML_3.99-0.9             fs_1.5.2                 tensor_1.5              </span>
<span class="co">## [145] reticulate_1.24          splines_4.2.0            spatstat.utils_2.3-0    </span>
<span class="co">## [148] pkgdown_2.0.3            plotly_4.10.0            systemfonts_1.0.4       </span>
<span class="co">## [151] xtable_1.8-4             fds_1.8                  jsonlite_1.8.0          </span>
<span class="co">## [154] corpcor_1.6.10           R6_2.5.1                 Hmisc_4.7-0             </span>
<span class="co">## [157] ramify_0.3.3             pillar_1.7.0             htmltools_0.5.2         </span>
<span class="co">## [160] mime_0.12                glue_1.6.2               fastmap_1.1.0           </span>
<span class="co">## [163] BiocParallel_1.30.0      deSolve_1.32             codetools_0.2-18        </span>
<span class="co">## [166] pcaPP_2.0-1              mvtnorm_1.1-3            utf8_1.2.2              </span>
<span class="co">## [169] lattice_0.20-45          bslib_0.3.1              spatstat.sparse_2.1-1   </span>
<span class="co">## [172] tibble_3.1.6             curl_4.3.2               leiden_0.3.10           </span>
<span class="co">## [175] gtools_3.9.2             survival_3.3-1           rmarkdown_2.14          </span>
<span class="co">## [178] desc_1.4.1               munsell_0.5.0            GetoptLong_1.0.5        </span>
<span class="co">## [181] GenomeInfoDbData_1.2.8   iterators_1.0.14         reshape2_1.4.4          </span>
<span class="co">## [184] gtable_0.3.0             spatstat.core_2.4-2</span></code></pre>
</div>
  </main>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Mingbo Cheng.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
